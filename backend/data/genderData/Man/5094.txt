SESTO SAN GIOVANNI, Italy  —   It was a routine identity check, the kind Italy has relied on to stem the flow of illegal migration deeper into Europe. But the man stopped by two police officers around 3 a. m. Friday outside the northern city of Milan was anything but an ordinary drifter. He turned out to be perhaps Europe’s most wanted man, Anis Amri, the chief suspect in the deadly terrorist attack on a Christmas market in Berlin that killed 12 people. Asked to show his papers and empty his backpack, he pulled out a gun, shot one officer, and in turn was shot and killed by another. “Police bastards,” Mr. Amri, who turned 24 this week, shouted in Italian before dying, according to the account given by Antonio De Iesu, director of the Milan police, at a news conference. For Italy, the shooting death of Mr. Amri, a Tunisian who had pledged his allegiance to the Islamic State’s supreme leader in a video released by the group on Friday, spurred a moment of national pride and some reassurance that its security measures were working. For Germany, it brought a sense of palpable relief after a week of national anguish. “Now I can wish you all a really peaceful Christmas,” the German interior minister, Thomas de Maizière, told reporters Friday afternoon, as he thanked his Italian counterparts. But the death also raised numerous questions about Mr. Amri’s movements and motivations, as well as about the potential gaps in the security of a Europe with open borders. Law enforcement authorities issued a   warrant on Wednesday for Mr. Amri, who migrated to Italy in 2011 and was imprisoned for four years in six different prisons in Sicily before making his way to Germany in 2015. Italy officially classified Mr. Amri as a terrorism risk after he threatened to decapitate a Christian cellmate in prison in Palermo in 2014, according to Lorenzo Vidino, who chairs an Italian commission of experts on radicalization that was formed this fall. “He was basically a troublemaker, very aggressive and very violent. And then from there, he starts a whole trajectory,” said Mr. Vidino, who said that the Tunisian migrant was arrested soon after his arrival by boat on the Italian island of Lampedusa in 2011, after    arson episodes. “He establishes a track record of bad behavior, which at the beginning was just aggressive and threatening and disrespectful. But in the last place, where he was held in a   prison in Palermo, he showed signs of radicalism. ” The threat to his cellmate was considered serious enough that officials added him to Italy’s database of radicalized individuals, a list that includes only a few hundred names, said Mr. Vidino, who is also the director of the Program on Extremism at George Washington University. Both Italy and Germany tried to deport him to Tunisia but were thwarted by a lack of documents and cooperation from his home country. Even after Mr. Amri was named as the prime suspect in the attack in Berlin, he was able to roam freely around Europe, his face plastered across the news media and a reward of more than $100, 000 on his head. “This mobility is great for the   and equally great for the  ” said Douglas H. Wise, a former senior C. I. A. officer, of the borderless travel within the European Union. What Mr. Amri did in the four days between the attack in Berlin and when he was ultimately killed in Sesto San Giovanni, a suburb north of central Milan, is not clear, but that is now the subject of an intense investigation that the authorities remain reluctant to discuss. Asked on Friday when exactly the authorities began to view Mr. Amri as a suspect, the head of Germany’s federal criminal police, Holger Münch, restated in general terms that it was on Tuesday, after investigators found an identity document in a wallet in the cab of the   used in the attack. The police have not said why the wallet was not discovered on Monday, when the attack occurred and a murdered driver was found in the cab. On Friday, Mr. Münch for the first time mentioned that an alias was involved, but he said the police had quickly linked it to Mr. Amri. In Italy, Mr. Vidino said that a train ticket found on Mr. Amri’s body showed that he had traveled by train to Turin in Italy from the French town of Chambéry, near the border between the two nations. But there is no trail suggesting how he got from Berlin to Chambéry. A senior European counterterrorism official said that the delay in identifying Mr. Amri probably gave him a crucial head start of several hours to flee Germany, and that he would have been able to buy a train ticket to France and Italy without showing identification papers.   software on surveillance cameras in Europe is still in rudimentary form in most places, the official said, so even after Mr. Amri was identified, he could have slipped through the train stations undetected, especially if he was wearing a hat or hood. Mr. Amri’s ability to hide through the week and make his way from Germany, through France, to Italy also raised questions of whether he had the help of a broader network, particularly one possibly linked to the Islamic State. The group called Mr. Amri “a soldier” in the video released on Friday, in which Mr. Amri proclaimed loyalty to its leader, Abu Bakr   and declared that the attack in Berlin was intended to avenge coalition airstrikes in Syria that have killed civilians. The video was evidently filmed in the Moabit district of northern Berlin, on the Kieler bridge. The autumn foliage seen on trees suggested it was filmed in fall or even early December. In Germany, Mr. Amri came on the radar of the authorities in part for suspected ties to a      Salafist preacher who went by the name Abu Walaa and who was jailed just weeks ago on suspicion of recruiting fighters to join the Islamic State. “There is high suspicion that he was behind the departure of a number of Germans to Syria  —   as many as two dozen  —   but the intelligence is not clear as to his exact role, whether in radicalization, recruitment or terror financing,” said Laith Alkhouri, a director at Flashpoint, a business risk intelligence company in New York that tracks militant and cyber threats. In a telephone call from the suspect’s hometown in Tunisia, Mr. Amri’s older brother, Walid, said that the family wondered whether he became radicalized while in jail in Italy. After his brother was released, he informed the family that he was leaving for Germany “with friends he had made in jail,” Walid Amri said. Also unknown is whether Mr. Amri had any accomplices in the Berlin attack  —   a question that Peter Frank, Germany’s top federal prosecutor, identified as a priority for investigators. “It is very important now to determine if there was a network of cooperators, a network of supporters, accessories or assistants helping him to prepare the attack, execute the attack and also to escape,” he said at a news conference on Friday in Karlsruhe, Germany. The only uncertainty that seemed to be settled on Friday was that the man killed was indeed Mr. Amri. “There is absolutely no doubt that the person who was killed was Anis Amri, the suspect in the terrorist attack in Berlin,” the Italian interior minister, Marco Minniti, said at a news conference. “As soon as this person entered our country, he was the most wanted man in Europe, and we immediately identified him and neutralized him,” Mr. Minniti said. “This means that our security is working really well. ” Some analysts, however, said that Mr. Amri’s flight over the past 72 hours from German to Italy through France underscored Europe’s porous border controls. “Terrorists with multiple false identification documents are able to exploit Europe’s open borders. Just as Amri arrived in Europe and moved almost seamlessly around the continent before the Berlin attack, he was able to do the same after it,” said Seth G. Jones, a terrorism specialist at the RAND Corporation. Mr. Amri traveled from Turin to Central Station in Milan, where he arrived around 1 a. m. Friday. Surveillance cameras in the Milan train station recorded Mr. Amri’s movements, Italian investigators said. It was not clear how Mr. Amri made his way to Sesto San Giovanni, about four miles away. “How he traveled there and what he was doing there are subject to delicate investigations,” Mr. De Iesu, of the Milan police, said at the news conference. “We have to understand whether he was in transit or was awaiting someone. ” Sesto San Giovanni is a “a strategic hub for transportation,” the town’s deputy mayor, Andrea Rivolta, said in an interview at city hall. “Sesto is a junction for the railway system, the Milan metro, municipal buses and buses that reach all of Europe,” as well as southern Italy. According to the account provided by Mr. De Iesu, Mr. Amri was standing alone on a piazza in Sesto San Giovanni, next to the northern terminus of a subway line. When the officers stopped him and asked for identification, he responded, in good Italian with a North African accent, that he was not carrying any documents on him. They asked him to empty his pockets and backpack. He was carrying a small knife and the equivalent of a few hundred dollars, but no cellphone. But then he pulled out a pistol, Mr. De Iesu said. “It was a regular patrol, under the new system of intensified police checks on the territory,” he said. “They had no perception that it could be him, otherwise they’d have been more careful. ” The officer whom Mr. Amri shot, identified as Cristian Movio, was wounded in the shoulder and had surgery on Friday. The other officer, who shot Mr. Amri, was identified as Luca Scatà.