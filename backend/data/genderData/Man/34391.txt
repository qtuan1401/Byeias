Paris (CNN) There was so much at stake that it was almost difficult to watch.  For more than two hours, the anchors of France’s final presidential debate struggled to get a word in edgeways as the two election finalists took each other more frontally and aggressively than at any point in the campaign so far.  The result was electric.  On the economy, on security, on the history of France and on the very nature of its society, the far right’s Marine Le Pen and the independent centrist Emmanuel Macron laid into each other’s programs and into each other.  Macron called Le Pen a liar and accused her of sowing hatred. Her policies would lead to ”civil war,” he said.  She accused him of being soft on terrorism and said he would preside over a nation enfeebled by its powerful neighbor, Germany. ”France will be led by a woman    either me or Mrs Merkel,” she said. Their two visions of what France should be could not have been more different. Neither could their styles.  She wants to leave the European Union and NATO, to bring in economic protectionism and to close France’s borders. He is a   globalist who represents continuity in policy terms but a desire to shake up France’s political elites.  Since taking over the National Front from her father   Le Pen has sought to tone down the party’s racist and   image, but she remains a populist who speaks to the guts of the French. Macron is an intellectual with a tendency toward wordiness. But on Wednesday night both got down into the pit with no punches held and no blows too low. Le Pen blasted Macron as a ”smirking banker” and appeared to mock his marriage. ”Don’t play teacher and pupil. It’s not my thing,” she said. (Macron met his future wife when she was his high school drama teacher.)  Macron did not pull his punches, deriding her habit of referring to her notes and denouncing her as a ”priestess of fear.” Le Pen had profited on the anger of the French people and promoted the ”spirit of defeatism,” he said.  ”France deserves better than you.” As Le Pen spoke, French journalists   her every word, calling her out on several of her pledges and accusations.  But it was hardly necessary: Macron, with a determined steeliness and a relentless calm, took apart her program and defended what had appeared to be the harder case to make: that the answer to France’s problems was more Europe rather than less, more openness rather than any closure and a thoughtful rather than   reaction to the terrorist threat.  Sitting directly opposite Macron, Le Pen seemed at times out of her depth, especially on the economy and on Europe. She also appeared to be speaking to her core electorate rather than reaching out beyond it with a message and style that might have seemed more presidential.  Instead she remained faithfully herself, and summed it up best at the end. ”Perhaps,” she said, ”people will say I am a bit lame, but I want to defend France as it is, ancient, with its borders and with its people who deserve better.” This was Macron’s debate to lose. Any misstep could have cost him at least part of his   lead in the polls.  Yet he chose to give as good as he got, proving at times even more aggressive and downright personal than Le Pen.  Macron’s final flourish, which was an appeal for a very different sort of change to the one Le Pen is proposing, is no doubt what will remain in the minds of voters. ”Your project,” he said, ”is one that aims to live in fear and amid lies. It is what fed your father and the French far right over decades. The France I want is much better than that, it will not be divided. But we do have to leave a system that helped create you. You live off it. You are its parasite.”  A snap poll conducted for CNN affiliate BFMTV said  63% of those who participated in survey after the debate found Macron more convincing than Le Pen. By Sunday night in France, the voters will deliver their real verdict on the two visions so spectacularly laid out tonight.