KABUL, Afghanistan  —   A suicide bomber struck a crowded gathering of Shiite Muslims in the Afghan capital on Monday, officials said, killing at least 30 people in the latest assault against religious minorities here to be claimed by militants loyal to the Islamic State. The suicide bomber detonated his explosives just as hundreds of worshipers had packed into the Baqir   mosque, in western Kabul. They were commemorating Arbaeen, a Shiite observance of loss and grief that comes 40 days after Ashura, when a grandson of the Prophet Muhammad was martyred. The Islamic State had claimed an attack during that holiday as well, bombing another Shiite shrine in Kabul on the eve of Ashura, and killing at least 14. Sediq Sediqqi, a spokesman for the Interior Ministry, said that at least 30 people had been killed and at least 40 wounded. The blast was so powerful that the windows from all three floors of the mosque were blown away. The walls looked as if they had been hosed with blood. Human remains, shoes, bloodied copies of the Quran and broken prayer beads were scattered around the hall. The large pots of rice cooking in the yard to feed about 700 people after the event remained unopened. Salman Firuzi, one of the worshipers present at the mosque during the blast, said about 500 men were on the ground floor, where the bomber detonated his explosives, and a similar number of women were on the second floor. “We were offering the final prayer when we heard a big bang and saw a big flame,” said Mr. Firuzi, his clothes soaked with the blood of the bodies he had helped load into cars. “We personally transferred some 20 dead bodies to private vehicles that we had take them to hospital. ” Hours after a Taliban spokesman denied responsibility for the attack, the Islamic State issued a statement by its central Amaq news agency saying that the group’s affiliates in Afghanistan had been responsible for the assault. This was the third major attack against Shiites that the terrorist group had carried out in Kabul in the past three months, and the frequency of the assaults has many worried that the government is unable to protect vulnerable groups. That concern, and the outrage by minorities who say the government and its American allies are not doing enough, has further stoked sectarian and factional tensions that are roiling Afghanistan. The deadliest of the attacks claimed by the Islamic State targeted a protest by the Hazaras, who are mostly Shiite, in July, leaving at least 80 people dead. “This appalling attack on worshipers is an atrocity,” said Pernille Kardel, the United Nations secretary general’s deputy special representative for Afghanistan. She expressed “revulsion at this latest effort by extremists to stoke sectarian violence in Afghanistan. ” The Islamic State’s ability to strike the capital city with regularity has punctured the Afghan government’s assurances that the extremist group has been contained to small pockets in the east of the country. Since early 2015, the group has gained a foothold across several districts in Nangarhar Province, where it has wrecked havoc. Estimates for the number of Islamic State fighters in Nangarhar have ranged from 1, 500 to 4, 000, most of them former members of the Pakistani and Afghan Taliban. The Afghan government has maintained pressure on the group’s havens, allocating both ground and air resources, and backed up by American airstrikes. American military advisers have also been deployed to help, and have been killed in the fighting. But in recent months, officials have admitted that their operations have not rooted out the threat, with the Islamic State simply relocating to another district when pressed in one. Still, some officials have expressed doubt that the group of Islamic State fighters in Nangarhar was behind the latest urban attacks. One senior Afghan security official, speaking on the condition of anonymity to discuss intelligence, said there was some doubt about whether the pocket of Islamic   fighters in the east had the capacity or the networks to pull off such   terrorist attacks. Shahgul Razaee, a member of the Afghan Parliament, said that the recent attacks in Kabul targeting Shiites “are a part of a systematic killing of a specific ethnic and religious group,” and that the government had proved unable to do anything about it. “What the government is doing by being careless is that it is leading people to ethnic divisions,” Ms. Razaee said. “It will increase the distance between the government and the people, and some people will think that the government belongs to a specific group and not all of the people. ”