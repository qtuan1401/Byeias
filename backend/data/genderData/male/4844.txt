A judge ruled Monday that deposition testimony from a civil lawsuit in which Bill Cosby acknowledged obtaining quaaludes as part of his efforts to have sex with women can be admitted as evidence in his coming criminal trial. Prosecutors have described the testimony, given by Mr. Cosby in a 2005 lawsuit and portions of which became public in July 2015 as crucial evidence that led them to reopen the investigation into an accusation by a former Temple University staff member that he had sexually assaulted her. The Montgomery County, Pa. district attorney’s office charged Mr. Cosby last year with drugging and molesting the former staff member, Andrea Constand, at his suburban Philadelphia home in 2004. Mr. Cosby’s lawyers had argued that the deposition should be suppressed because, they said, he had been induced to sit for the deposition, and waive his Fifth Amendment rights against   by an alleged promise by a former county district attorney not to prosecute him. The former district attorney, Bruce L. Castor Jr. had testified during a hearing in February that he hoped the promise would lead Mr. Cosby to testify in the civil case that had been brought by Ms. Constand. But in a   ruling, Judge Steven T. O’Neill of the Court of Common Pleas in Montgomery County said he found no evidence that there had ever been such an agreement. “This court concludes that there was neither an agreement nor a promise not to prosecute, only an exercise of prosecutorial discretion,” Judge O’Neill said. Mr. Cosby’s   criminal trial is currently scheduled to begin next June. In the deposition, Mr. Cosby never admitted to nonconsensual sex, but nevertheless presented himself as an unapologetic, cavalier playboy, someone who used a combination of fame, apparent concern and powerful sedatives in a calculated pursuit of young women. The profile was at odds with the popular image he so long enjoyed of father figure and public moralist. Andrew Wyatt, a spokesman for Mr. Cosby, declined to comment on the judge’s decision. In a statement, Kevin R. Steele, the current district attorney, said the ruling was “another step forward in this case and will aid the jury in making its determination. ” Mr. Cosby gave his testimony in the civil case over four days in September 2005 and March 2006. Ms. Constand eventually settled the lawsuit on undisclosed terms, but agreed to help in the prosecution of Mr. Cosby last year when approached by prosecutors. The decision is the latest in a series of setbacks for Mr. Cosby’s lawyers as they have sought to have the charges thrown out, or shape the evidence to be admitted at trial. Last month, Judge O’Neill rejected their argument that the delay of more than 10 years in bringing charges against Mr. Cosby denied him the right to a fair trial. At a hearing before Judge O’Neill next week, his lawyers are scheduled to argue against an attempt by Mr. Steele to introduce testimony by 13 other women who say they were also assaulted by Mr. Cosby.