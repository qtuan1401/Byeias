SAN FRANCISCO  —   As pitch after pitch played out, the goblins of past heartbreak began to creep back. If tales of goats, a fan named Steve Bartman and past playoff collapses and curses began to be revisited, another very real specter appeared in the head of Joe Maddon, the manager of the Chicago Cubs. It had dreadlocks, a barrel chest and a history of throwing darts at his team’s hitters. It was sitting in the home dugout on Tuesday night. “Johnny Cueto was etched all over my frontal lobe,” Maddon said of the San Francisco Giants pitcher who was itching for another shot at the Cubs in a     game back at Wrigley Field. “And I didn’t like it. ” There was a lot for Maddon not to like. The Cubs’     defeat the previous night seemed to have awoken the Giants, their October mojo now in full force behind the pitching of Matt Moore, who had held the Cubs to two hits through eight innings. Three more outs remained, and three runs needed to be scored, or the Cubs would be forced to return home for a fifth game of this National League division series amid their fans’ anxious embrace. Then the Cubs made something happen that usually seems to happen only to them. They not only got up off the mat, they seemed to crawl out from underneath it, scoring four times in the ninth inning to finish off the Giants with a   victory, winning the series, three games to one. When Aroldis Chapman, who gave up the lead on Monday night, blew a fastball past Brandon Belt for the final out, the Cubs emptied out of the dugout and mobbed one another on the infield grass, ecstatic to be back in the National League Championship Series for the second consecutive season. They will now await their next opponent  —   the Los Angeles Dodgers or the Washington Nationals  —   as they pursue their first World Series berth since 1945 and first championship since 1908. In the meantime, they can relish rebounding to vanquish the Giants, who had won the 2010, 2012 and 2014 World Series and a record 10 consecutive elimination games. “Any time you can survive like that against an October giant  —   it’s hard to finish any team in the postseason, let alone a team with that kind of character and competitors,” said Theo Epstein, the Cubs’ president for baseball operations. “What an amazing feat, to do it like that. ” When the Cubs came to bat in the ninth, their hopes were buoyed by the removal of Moore, who had allowed just two hits and two walks and struck out 10. He had also thrown 120 pitches. If a   lead seemed like a comfortable one for the Giants to protect, it was not so with their bullpen, which was about to blow its 32nd save of the season. One by one, a parade of five relievers came to the mound, none of them able to stop the Cubs. Kris Bryant singled. Anthony Rizzo walked. Ben Zobrist lined a double down the   line. When   Willson Contreras singled up the middle, he pounded his chest with his fist as he rounded first base, knowing that Zobrist had come around to tie the score. If the relievers let down the Giants, so did shortstop Brandon Crawford, who made two errors, one of which gifted the Cubs a run in the fifth. The other one set up the  . After Contreras’s hit, Jason Heyward bunted the ball back to pitcher Will Smith, who fired a strike to Crawford for a forceout. But Crawford, trying for a double play, sailed his throw past the first baseman, Belt, and into the Cubs’ dugout, sending Heyward to second. Javier Baez’s single up the middle scored Heyward, putting the Cubs in front. Baez jubilantly pounded his hands together as Heyward slid home. Zobrist understands well the power that a comeback like the Cubs’ can have in the playoff. Last year, he was with Kansas City, down by four runs in the eighth inning of an elimination game, when the Royals rallied to beat the Houston Astros and rode that momentum to a championship. “Every group has to find that identity,” Zobrist said. “We did it during the season, but you still have to find that identity in the postseason as well. ” That identity was forged on the eve of the playoffs, when the Cubs  —   who had the best record in the majors, with 103 victories  —   were gathered on the pitcher’s mound during a workout last Wednesday. “I said that something bad is going to happen, and we have to stay in the moment and maintain our composure,” said Maddon, who wore a customized wet suit during the team’s celebration in the clubhouse. “That was the exact message. ” Those moments have always been fraught for the Cubs, owing to their history of postseason heartbreak. In 1984, they ventured west to play the San Diego Padres with a   lead in a   National League Championship Series but lost three in a row. In 2003, they were again one win away from advancing to the World Series but lost three in a row, including the last two at home, to the Florida Marlins. For much of Tuesday night’s game, the Cubs seemed to be setting the stage for another one of those endings. Both starting pitchers, Moore and the Cubs’ John Lackey, arrived Tuesday having established almost immediately in their careers that they could rise to the occasion on a playoff stage  —   and they did so with Maddon on their bench. Moore’s second start in the big leagues was in the opener of a 2011 American League division series, when he rewarded Maddon, his manager at Tampa Bay, with a   shutout over seven innings at Texas. Lackey became the rare rookie to start and win a World Series Game 7, helping the Anaheim Angels beat the Giants in 2002. Lackey, an irascible Texan whose teammates steer clear of him on days he pitches, boarded the team bus on Tuesday afternoon with a black cowboy hat pulled down over his eyes. “Nothing’s contrived or fabricated with him,” said Maddon, who was the bench coach with the Angels when Lackey came up. “That’s who he is. ” Lackey muttered a few cross words to himself when the Giants scored twice in the fourth to take a   lead. After Crawford struck out, Conor Gillaspie and Joe Panik singled. Then Lackey walked Gregor Blanco, loading the bases. That brought up Moore, who did not have a hit in the big leagues until this season. After looking at the first two pitches for strikes, Moore lashed a single to right field, putting the Giants ahead and equaling his career R. B. I. total. It was the latest big hit by a pitcher in this series, though the first by one of the Giants. The Cubs’ pitchers had hit two home runs and driven in six runs in this series. Another run came across when Denard Span grounded to Rizzo at first base. Rizzo threw to second for a forceout, but Addison Russell’s return throw was just behind Lackey, who couldn’t keep his foot on the bag. Lackey retired Belt on a fly ball to avoid further damage, but it was his last pitch of the night. The Cubs closed to   in the fifth, when Crawford’s   throwing error on Baez’s grounder set up David Ross, who had earlier hit a solo homer. He lined an   pitch from Moore deep enough to right field to score Baez. Crawford quickly atoned for his mistake, crushing the first pitch he saw from reliever Justin Grimm off the top of the    brick wall in   field, good for a double that keyed a   rally, building the Giants’ lead to   which Moore carried into the ninth. It seemed then as if it would be enough, but perhaps for the Cubs it was a prelude to when they can write an even more satisfying ending.