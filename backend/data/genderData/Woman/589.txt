MOGADISHU, Somalia  —   When the first explosion rang out, the men on the hotel patio looked up for a moment, then at one another  —   and kept on eating breakfast. Mogadishu, the capital of Somalia, long ago grew accustomed to such jarring sounds, and nobody seemed surprised by a loud bang somewhere not too far away. It took another, even louder explosion a few minutes later to get everyone’s attention. Something fatal was going on. A   of the militiamen who guard the hotel piled into a pickup with their Kalashnikovs and ammunition vests while the photographer Tyler Hicks and I grabbed our gear  —   cameras, notebooks, bulletproof vests, press credentials, bottles of water  —   and climbed into an armored truck, slamming the door tight behind us. We headed for the hospital. I have been to Mogadishu many times, but this was my first visit in several years, and when I got to town, I was struck by how much progress the capital seemed to be making. There was still plenty of evidence of the   city of old  —   the crushed houses, craters and   walls  —   but there were also new apartment complexes, crowded markets and freshly painted shops selling   TVs. It was even possible to go out for pizza Tuesday night, something I would never have dared before. The scene at the hospital tore at that hopeful illusion. The floor was slippery with blood. Dozens of wounded people streamed in, bleeding from their heads, faces, feet, arms and backs. Some were covered in fine white dust from collapsed walls. Some lay on steel gurneys as squadrons of flies crawled over their shrapnel wounds. Some were clearly in pain. There was confusion, anger, shouting and a lot of sweat. Talking to witnesses, I began to piece together what had happened. Terrorists had struck at another hotel across town from ours, the Dayah: first with a bomb, and then with gunmen spraying fire at hotel guests. The attack ended with a second bomb. By the grim standards of Mogadishu, where terrorist attacks have sometimes killed as many as 50 people in an instant, the toll on Wednesday was not especially large. Government officials said later in the day that about 13 people had been killed, and about 50 had been wounded. The BBC reported that nearly 30 people were dead. No one I spoke to at the hospital had any doubt who was responsible: It must have been the Shabab, they said, meaning the Somali militant organization that has been terrorizing the country for years. The group later claimed responsibility. In the corner of one ward, a young man was lying with a   video camera next to him. He spoke a little English and said he felt good enough to talk. His name was Mohamed Abdihakim, and he was a freelance journalist, making his living filming the mayhem that Mogadishu regularly endures. When he heard the rumble of the first explosion roll across the rooftops like thunder, he said, he jumped into a   (a kind of motorized rickshaw) and urged the driver to head for the rising column of smoke as fast as he could. Along the way, he said, a colleague warned him by phone that it was never a good idea to be the first one on the scene of an attack. But Mr. Abdihakim, 28 and determined, said he had to get there, and he did  —   in time for the second explosion. He was standing next to some other journalists and filming the scene when the blast knocked them all to the ground. Both his hands were badly injured. “Do I have any regrets? No,” he said from his hospital bed, wearing mittens of gauze. “But maybe it’s time to do something else. ” There seemed to be hundreds of people at the hospital, and the crowd thickened by the minute as battered cars raced up with more casualties. Armed men shoved past us, waving guns menacingly at anyone in the way. For more than 25 years since its old central government collapsed, Somalia, one of the world’s poorest nations, has lurched from one crisis to another: civil war, famine, piracy, Islamic militancy. But in the last few years, it seemed as though another war was being waged for Mogadishu’s soul  —   between residents trying to get on with life and taste a little normalcy and those bent on ruin. Peacekeepers from the African Union have managed to stabilize the main cities in recent years,   militias have calmed down a bit, some foreign investment has flowed in and life has improved. Many roads are newly paved. There are now working streetlights and dry cleaners and cash machines, small miracles in a country that had become a byword for anarchy. Somalia is in the process of selecting a new president, who will be chosen by members of Parliament in the next few weeks. Government officials say the Shabab have been trying to derail that process, and attacked the Dayah Hotel on Wednesday because some newly elected representatives were staying there. A similar explanation appeared on a website associated with the group. The first explosion, officials said, was from a large truck bomb at the hotel gates. Four gunmen stormed in afterward, and the final explosion, a bomb in a minivan, went off about 15 minutes later. Three of the assailants were quickly shot, and the fourth killed himself with a suicide vest, officials said. From photos of their bodies, all appeared to be young, possibly even teenagers. According to Somali authorities, no government officials were killed in the attack. The dead were hotel guards, guests and bystanders.